var M=Object.defineProperty;var w=(t,e,r)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var a=(t,e,r)=>(w(t,typeof e!="symbol"?e+"":e,r),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}})();class p{constructor(){a(this,"name","Эльф");a(this,"recieverName","Эльфу");a(this,"charmedName","Эльфа");a(this,"accuracy",8);a(this,"strength",5);a(this,"armor",1);a(this,"maxHealth",10);a(this,"currentHealth",10);a(this,"speed",7)}}class f{constructor(){a(this,"accuracy",5);a(this,"strength",5);a(this,"armor",5);a(this,"speed",5);a(this,"maxHealth",10);a(this,"currentHealth",10);a(this,"magic",!1)}}class v extends f{constructor(){super();a(this,"name","Пехотинец");a(this,"recieverName","Пехотинцу");a(this,"charmedName","Пехотинца");this.strength=this.strength+2,this.armor=this.armor+3}}class $ extends f{constructor(){super();a(this,"name","Всадник");a(this,"recieverName","Всаднику");a(this,"charmedName","Всадника");this.armor=this.armor=1,this.speed+=5,this.strength+=1}}class u extends f{constructor(){super(...arguments);a(this,"name","Колдун");a(this,"recieverName","Колдуну");a(this,"charmedName","Колдуна");a(this,"magic",!0)}}class L{constructor(){a(this,"accuracy",4);a(this,"strength",6);a(this,"armor",5);a(this,"speed",3);a(this,"maxHealth",10);a(this,"currentHealth",10)}}class T extends L{constructor(){super();a(this,"name","Лёгкий орк");a(this,"recieverName","Лёгкому орку");a(this,"charmedName","Лёгкого орка");this.accuracy=this.accuracy+1,this.speed=this.speed+4}}class A extends L{constructor(){super();a(this,"name","Тяжелый орк");a(this,"recieverName","Тяжелому орку");a(this,"charmedName","Тяжелого орка");this.armor=this.armor+1,this.strength=this.strength+4,this.speed=this.speed-2}}const H=t=>{let e=Math.round(Math.random()*10);if(t===0)return e<4?new v:e<7?new $:e<10?new p:new u;if(t===1)return e<7?new p:e<8?new v:e<10?new $:new u;if(t===2)return e<5?new T:e<10?new A:new u},l=[0,0];let n=[[],[]];const C=["red","blue","silver"],Q=t=>{n=t},k=()=>{document.querySelector("#army1Quantity").style.display="none",document.querySelector("#redArmy").querySelector("h3").innerText=`Численость: ${n[0].length}`,document.querySelector("#army2Quantity").style.display="none",document.querySelector("#blueArmy").querySelector("h3").innerText=`Численость: ${n[1].length}`},S=()=>{document.querySelector("#army1Quantity").style.display="inline",document.querySelector("#redArmy").querySelector("h3").innerText="Численость:",document.querySelector("#army2Quantity").style.display="inline",document.querySelector("#blueArmy").querySelector("h3").innerText="Численость:"},E=()=>{const t=document.querySelectorAll(".army_list");t.forEach(e=>e.innerHTML=""),n[0].forEach(e=>{const r=document.createElement("li");r.innerText=`${e.name} - ${e.currentHealth}ХП`;const c=document.createElement("span");r.appendChild(c),c.style.backgroundColor="rgb(238, 83, 83)",c.style.width=`${e.currentHealth/(e.maxHealth/100)}%`,t[0].appendChild(r)}),n[1].forEach(e=>{const r=document.createElement("li");r.innerText=`${e.name} - ${e.currentHealth}ХП`;const c=document.createElement("span");r.appendChild(c),c.style.backgroundColor="rgb(99, 147, 252)",c.style.width=`${e.currentHealth/(e.maxHealth/100)}%`,t[1].appendChild(r)})},i=(t,e)=>{const r=document.createElement("p");r.innerText=t,r.classList.add(`${C[e]}_event`),eventList.appendChild(r),eventList.scrollTo(0,eventList.scrollHeight)},g=t=>{if(n[0].length>0&&n[1].length>0){let e=0,r=1;if(n[0][t]&&n[1][t]&&n[0][t].speed<n[1][t].speed&&(e=1,r=0),n[e].length>t){const c=Math.round(Math.random()*1e3)%n[r].length,o=n[e][t],s=n[r][c];if(Math.round(Math.random()*10)<=o.accuracy)if(o.magic)n[r].splice(c,1),n[e].push(s),i(`Колдун перманил ${s.charmedName}`,e);else{const d=o.strength/10*s.armor;n[r][c].currentHealth=(s.currentHealth-d).toFixed(2),i(`${o.name} нанёс ${d} урона ${s.recieverName}`,e),s.currentHealth<=0&&(n[r].splice(c,1),i(`${s.name} умер`,r))}}if(n[r].length>t){const c=Math.round(Math.random()*1e3)%n[e].length,o=n[r][t],s=n[e][c];if(Math.round(Math.random()*10)<=o.accuracy)if(o.magic)n[e].splice(c,1),n[r].push(s),i(`Колдун перманил ${s.charmedName}`,r);else{const d=o.strength/10*s.armor;n[e][c].currentHealth=(s.currentHealth-d).toFixed(2),i(`${o.name} нанёс ${d} урона ${s.recieverName}`,r),s.currentHealth<=0&&(n[e].splice(c,1),i(`${s.name} умер`,e))}}if(k(),E(),n[0].length===0)return i("Победила синяя армия",2),S();if(n[1].length===0)return i("Победила красная армия",2),S()}},N=document.querySelectorAll(".race_picker"),q=t=>{N[t].querySelector("h2").innerText=races[l[t]]};N.forEach((t,e)=>{const r=t.querySelectorAll("span");r[0].addEventListener("click",()=>{l[e]===0?l[e]=2:l[e]-=1,q(e)}),r[1].addEventListener("click",()=>{l[e]===2?l[e]=0:l[e]+=1,q(e)})});const O=document.querySelector("#gatherArmies");O.addEventListener("click",()=>{let t=[];t[0]=parseInt(document.querySelector("#army1Quantity").value),t[1]=parseInt(document.querySelector("#army2Quantity").value),t=t.map(r=>isNaN(r)?10:r);let e=1;Q([[],[]]);for(let r=0;r<t[0];r++){const c=H(l[0]);c.name=`${c.name} ${e}`,c.recieverName=`${c.recieverName} ${e}`,n[0].push(c),e++}for(let r=0;r<t[1];r++){const c=H(l[1]);c.name=`${c.name} ${e}`,c.recieverName=`${c.recieverName} ${e}`,n[1].push(c),e++}E()});document.querySelector("#makeMove").addEventListener("click",()=>{const t=n[0].length,e=n[1].length,r=t>e?t:e;for(let c=0;c<r;c++)n[0].length>0&&n[1].length>0&&g(c)});document.querySelector("#endFight").addEventListener("click",()=>{for(;n[0].length>0&&n[1].length>0;){const t=n[0].length,e=n[1].length,r=t>e?t:e;for(let c=0;c<r;c++)n[0].length>0&&n[1].length>0&&g(c)}});let h=!1;const x=()=>{if(n[0].length>0&&n[1].length>0&&h){const t=n[0].length,e=n[1].length,r=t>e?t:e;for(let c=0;c<r;c++)n[0].length>0&&n[1].length>0&&g(c);setTimeout(x,500)}},y=document.querySelector("#autoFight");y.addEventListener("click",()=>{!h&&n[0].length>0&&n[1].length>0?(h=!0,y.innerText="Остановить бой",setTimeout(x,500)):(y.innerText="Автоматический бой",h=!1)});
